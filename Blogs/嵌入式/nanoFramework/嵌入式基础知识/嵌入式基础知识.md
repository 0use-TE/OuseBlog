#                                                                嵌入式基础知识

## MCU 输入输出模式笔记

MCU的GPIO（通用输入输出）口是非常灵活的，能根据需要设置成不同的模式。理解这些模式是写驱动、调试硬件的基础。

### 一、GPIO的基本模式

| 模式名称                          | 说明                                                       | 举例用途                       |
| --------------------------------- | ---------------------------------------------------------- | ------------------------------ |
| **输入模式 (Input)**              | 管脚作为输入，读取外部电平状态。                           | 读取按键、传感器信号           |
| **上拉输入 (Input Pull-Up)**      | 输入模式基础上，管脚内部有上拉电阻，防止悬空。             | 按键输入避免悬空高电平         |
| **下拉输入 (Input Pull-Down)**    | 输入模式基础上，管脚内部有下拉电阻。                       | 某些传感器信号接地避免悬空     |
| **推挽输出 (Output Push-Pull)**   | 管脚内部有驱动上下晶体管，可主动输出高低电平。             | 控制LED灯、驱动继电器、PWM输出 |
| **开漏输出 (Output Open-Drain)**  | 只能主动拉低电平，拉高靠外部上拉电阻。常用于总线共享场合。 | I2C总线、单线通讯              |
| **模拟输入 (Analog Input)**       | 连接到ADC，读取模拟信号。                                  | 读取传感器电压值               |
| **复用功能 (Alternate Function)** | 管脚用来连接芯片内部外设，如UART、I2C、PWM等。             | 连接外设通信、定时器输出       |



------

### 二、常见输入输出模式总结

| 术语                     | 详细说明                   | 代码举例（STM32 HAL）                                        |
| ------------------------ | -------------------------- | ------------------------------------------------------------ |
| GPIO_MODE_INPUT          | 纯输入模式，无上下拉       | `GPIO_InitStruct.Mode = GPIO_MODE_INPUT;`                    |
| GPIO_MODE_INPUT_PULLUP   | 输入模式，带内部上拉       | `GPIO_InitStruct.Mode = GPIO_MODE_INPUT; GPIO_InitStruct.Pull = GPIO_PULLUP;` |
| GPIO_MODE_INPUT_PULLDOWN | 输入模式，带内部下拉       | `GPIO_InitStruct.Mode = GPIO_MODE_INPUT; GPIO_InitStruct.Pull = GPIO_PULLDOWN;` |
| GPIO_MODE_OUTPUT_PP      | 推挽输出模式               | `GPIO_InitStruct.Mode = GPIO_MODE_OUTPUT_PP;`                |
| GPIO_MODE_OUTPUT_OD      | 开漏输出模式               | `GPIO_InitStruct.Mode = GPIO_MODE_OUTPUT_OD;`                |
| GPIO_MODE_AF_PP          | 复用推挽输出，用于连接外设 | `GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;`                    |
| GPIO_MODE_AF_OD          | 复用开漏输出，用于连接外设 | `GPIO_InitStruct.Mode = GPIO_MODE_AF_OD;`                    |
| GPIO_MODE_ANALOG         | 模拟输入模式               | `GPIO_InitStruct.Mode = GPIO_MODE_ANALOG;`                   |



------

## MCU常见管脚名称及含义

| 管脚名称         | 说明                                                         | 例子                                          |
| ---------------- | ------------------------------------------------------------ | --------------------------------------------- |
| **VIN**          | 输入电压管脚，连接外部电源输入。通常有一个稳压模块接入。     | Arduino板上的12V输入口                        |
| **VCC**          | 稳压后的芯片工作电压（电源正极），MCU主供电引脚。            | 3.3V或5V供电线                                |
| **GND**          | 地线，电源负极，所有电路的公共参考点。                       | MCU电源地线                                   |
| **EN**（Enable） | 使能管脚，控制芯片或模块的工作状态。高电平使能，低电平关闭或休眠。 | MCU复位使能，电源管理芯片使能引脚             |
| **Boot**         | 启动模式选择管脚，用于决定芯片启动时的引导方式。             | STM32的BOOT0引脚，决定从Flash或系统存储器启动 |
| **On**           | 有时用于指示开机状态或电源开关信号。                         | 开关信号引脚                                  |
| **Up**           | 一般表示“上拉”或方向上的信号，具体含义看设计。               | 可能是上拉使能脚，或某些特定功能脚            |



------

## 常用通信协议简介

这些协议经常在MCU和外设之间通信，是你写驱动必会的。

#### 1. PWM（Pulse Width Modulation，脉宽调制）

- **用途：** 通过调节信号的占空比，实现模拟量控制的效果，比如调节电机速度、LED亮度。
- **原理：** 固定频率方波，改变高电平持续时间占比（占空比）。
- **举例：** 50%占空比的PWM信号表示高低电平各一半时间，输出模拟电压约为一半。

------

#### 2. I2C（Inter-Integrated Circuit，串行总线）

- **用途：** 两线式串行通信，用于MCU与多个外设通信，如传感器、EEPROM等。
- **线路：** SDA（数据线）、SCL（时钟线），均为开漏输出，需外部上拉电阻。
- **特点：** 支持多主多从，设备地址唯一。通信速度标准100kHz，快速模式400kHz等。

------

#### 3. UART（Universal Asynchronous Receiver/Transmitter，通用异步收发传输器）

- **用途：** 串口通信，点对点异步通信。常用于调试、模块通信（如蓝牙、GPS）。
- **线路：** TX（发送），RX（接收），有时加上RTS/CTS硬件流控。
- **特点：** 无时钟线，数据帧格式包含起始位、数据位、校验位和停止位。波特率双方需一致。